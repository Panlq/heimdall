refeactor https://github.com/gojek/valkyrie
